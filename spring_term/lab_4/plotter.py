import matplotlib.pyplot as plt
import numpy as np

def read_data(filename):
    x, y = [], []
    with open(filename, 'r') as f:
        for line in f:
            xi, yi = map(float, line.split())
            x.append(xi)
            y.append(yi)
    return np.array(x), np.array(y)

x_s100, y_s100 = read_data('data/shooting_100.txt')
x_s200, y_s200 = read_data('data/shooting_200.txt')
x_s400, y_s400 = read_data('data/shooting_400.txt')
x_s500, y_s500 = read_data('data/shooting_500.txt')
x_s750, y_s750 = read_data('data/shooting_750.txt')
x_s800, y_s800 = read_data('data/shooting_800.txt')
x_s1000, y_s1000 = read_data('data/shooting_1000.txt')

x_q100, y_q100 = read_data('data/quasi_100.txt')
x_q200, y_q200 = read_data('data/quasi_200.txt')
x_q400, y_q400 = read_data('data/quasi_400.txt')
x_q500, y_q500 = read_data('data/quasi_500.txt')
x_q750, y_q750 = read_data('data/quasi_750.txt')
x_q800, y_q800 = read_data('data/quasi_800.txt')
x_q1000, y_q1000 = read_data('data/quasi_1000.txt')

plt.figure(figsize=(8, 6))
plt.plot(x_s100, y_s100, 'o-', label='N=100', markersize=3)
plt.plot(x_s200, y_s200, 'o-', label='N=200', markersize=2)
plt.plot(x_s400, y_s400, 'o-', label='N=400', markersize=1)
plt.plot(x_s500, y_s500, 'o-', label='N=500', markersize=1)
plt.plot(x_s750, y_s750, 'o-', label='N=750', markersize=1)
plt.plot(x_s800, y_s800, 'o-', label='N=800', markersize=1)
plt.plot(x_s1000, y_s1000, 'o-', label='N=1000', markersize=1)
plt.xlabel('x')
plt.ylabel('y')
plt.title('Метод стрельбы')
plt.legend()
plt.grid(True)
plt.savefig('plots/shooting_solutions.png')
plt.close()

plt.figure(figsize=(8, 6))
plt.plot(x_q100, y_q100, 'o-', label='N=100', markersize=3)
plt.plot(x_q200, y_q200, 'o-', label='N=200', markersize=2)
plt.plot(x_q400, y_q400, 'o-', label='N=400', markersize=1)
plt.plot(x_q500, y_q500, 'o-', label='N=500', markersize=1)
plt.plot(x_q750, y_q750, 'o-', label='N=750', markersize=1)
plt.plot(x_q800, y_q800, 'o-', label='N=800', markersize=1)
plt.plot(x_q1000, y_q1000, 'o-', label='N=1000', markersize=1)
plt.xlabel('x')
plt.ylabel('y')
plt.title('Метод квазилинеаризации')
plt.legend()
plt.grid(True)
plt.savefig('plots/quasi_solutions.png')
plt.close()

plt.figure(figsize=(8, 6))
plt.plot(x_s100, np.abs(y_s100 - y_q100), 'o-', label='|y_shooting - y_quasi|, N=100')
plt.plot(x_s200[::2], np.abs(y_s200[::2] - y_q200[::2]), 'o-', label='|y_shooting - y_quasi|, N=200')
plt.plot(x_s400[::4], np.abs(y_s400[::4] - y_q400[::4]), 'o-', label='|y_shooting - y_quasi|, N=400')
plt.plot(x_s500[::4], np.abs(y_s500[::4] - y_q500[::4]), 'o-', label='|y_shooting - y_quasi|, N=500')
plt.plot(x_s750[::4], np.abs(y_s750[::4] - y_q750[::4]), 'o-', label='|y_shooting - y_quasi|, N=750')
plt.plot(x_s800[::4], np.abs(y_s800[::4] - y_q800[::4]), 'o-', label='|y_shooting - y_quasi|, N=800')
plt.plot(x_s1000[::4], np.abs(y_s1000[::4] - y_q1000[::4]), 'o-', label='|y_shooting - y_quasi|, N=1000')
plt.xlabel('x')
plt.ylabel('|y_shooting - y_quasi|')
plt.title('Различие между методами')
plt.legend()
plt.grid(True)
plt.savefig('plots/difference.png')
plt.close()